<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>

<script type="text/babel">

/******************************************************************************
 * SelectPlayers
 *
 * Select the number of players that are playing hand and foot.
 * Choose between 4, 6, or 8 players.
 *****************************************************************************/
class SelectPlayers extends React.Component {
  constructor(props) {
    super(props)
    this.handleSelectChange = this.handleSelectChange.bind(this)
  }
  
  handleSelectChange(e) {
    this.props.onSelectChange(e.target.value)
  }

  render() {
    if (this.props.optionsSet === false) {
      return (
        <div>
          <label>Number of Players: </label>
          <select 
            value={this.props.opVal}
            onChange = {this.handleSelectChange}
          >
            <option value="None">Choose...</option>
            <option value="4">4</option>
            <option value="6">6</option>
            <option value="8">8</option>
          </select>
        </div>
      )
    } else {
        return null;
    }
  }
}

/******************************************************************************
 * NameInput
 *****************************************************************************/
class NameInput extends React.Component {
  constructor(props) {
    super(props)
    this.handleNameChange = this.handleNameChange.bind(this)
    this.handleSubmit = this.handleSubmit.bind(this)
  }
  
  handleNameChange(e) {
    this.props.onNameChange(e)
  }
  
  handleSubmit(e) {
    this.props.onSubmitForm(e)
  }
  
  createInputs() {
    let inputs = []
    
    for(let i = 0; i < this.props.opVal; i++) {
      if(i % 2 == 0) {
        inputs.push(<h3>Group {(i + 2) / 2}</h3>)
      }
      const name = "player" + (i + 1)
      inputs.push(
        <div>
          <label htmlFor={name}>Name: </label>
          <input name={name} type="firstname" aria-required="true" value={this.props.name} onChange={this.handleNameChange} required />
        </div>
      )
    }
    return inputs
  }
  
  render() {
    if(this.props.opVal == "None" || this.props.optionsSet === true) {
      return null
    } else {
      return (
        <form onSubmit={this.handleSubmit}>
          {this.createInputs()}
          <div>
            <button>Start Game</button>
          </div>
        </form>
      )
    }
  }
}

/******************************************************************************
 * Player
 *****************************************************************************/
class Player extends React.Component {
  constructor(props) {
    super(props);
  }

  componentDidMount() {
    // template
  }

  componentWillUnmount() {
    // template
  }

  render() {
    return (
      <div>
        <p>{this.props.player.name} - {this.props.player.score}</p>
      </div>
    )
  }
}

/******************************************************************************
 * Group
 * 
 * A group consists of two players.
 *****************************************************************************/
class Group extends React.Component {
  constructor(props) {
    super(props);
  }

  componentDidMount() {
    // template
  }

  componentWillUnmount() {
    // template
  }
}


/******************************************************************************
 * Score
 *****************************************************************************/
class Score extends React.Component {
  constructor(props) {
    super(props);
  }

  componentDidMount() {
    // template
  }

  componentWillUnmount() {
    // template
  }

  render() {
    if (this.props.optionsSet === false) {
      // do not render the score
      return null;
    } else {
      let scores = [];

      for(const player in this.props.players) {
        scores.push(
          <div>
            <Player player={this.props.players[player]} />
          </div>
        );
      }
      return scores;
    }
  }
}

/******************************************************************************
 * HandAndFootApp
 *****************************************************************************/
class HandAndFootApp extends React.Component {
  constructor(props) {
    super(props)

    this.state = {
      opVal: "None",
      players: [],
      optionsSet: false
    }

    this.handleSelectChange = this.handleSelectChange.bind(this)
    this.handleNameChange = this.handleNameChange.bind(this)
    this.handleSubmit = this.handleSubmit.bind(this)
  }
  
  handleSelectChange(opVal) {
    this.setState( {opVal: opVal}, () => console.log(this.state.opVal) )
  }
  
  handleNameChange(event) {
    this.setState({
      players: {
        ...this.state.players,
        [event.target.name]: {
          name: event.target.value,
          score: 0,
          round1: {
            pick22: 0,
            out: 0,
            black: 0,
            red: 0,
            wild: 0,
            points: 0,
            score: 0
          },
          round2: {
            pick22: 0,
            out: 0,
            black: 0,
            red: 0,
            wild: 0,
            points: 0,
            score: 0
          },
          round3: {
            pick22: 0,
            out: 0,
            black: 0,
            red: 0,
            wild: 0,
            points: 0,
            score: 0
          },
          round4: {
            pick22: 0,
            out: 0,
            black: 0,
            red: 0,
            wild: 0,
            points: 0,
            score: 0
          }
        }
      }
    }, () =>
      console.log(this.state)
    )
  }
  
  handleSubmit(event) {
    event.preventDefault();
    this.setState( {optionsSet: true}, () => console.log(this.state.optionsSet))

    console.log(this.state);
  }
  
  render() {
    return (
      <div>
        <SelectPlayers
          opVal = {this.state.opVal}
          optionsSet = {this.state.optionsSet}
          onSelectChange = {this.handleSelectChange}
        />
        <NameInput 
          opVal = {this.state.opVal}
          optionsSet = {this.state.optionsSet}
          onNameChange = {this.handleNameChange}
          onSubmitForm = {this.handleSubmit}
        />
        <Score
          players = {this.state.players}
          optionsSet = {this.state.optionsSet}
        />
      </div>
    )
  }
}

ReactDOM.render(
  <HandAndFootApp />,
  document.getElementById('root')
)
</script>

<h1>Hand and Foot</h1>

<div id="root"></div>